<?xml version="1.0" encoding="UTF-8"?>
<project name="JavaFX Deployment" default="default" basedir=".">
<!--
 /* Copyright (c) 2011, 2012, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the "Classpath" exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */
-->
    <!-- Import common properties and definitions -->
    <import file="../../build-defs.xml"/>

    <property name="ws.deploy.cache.dir"
              location="${jfx.root.dir}/rt/deploy/cache"/>

    <target name="default" depends="jfx-sdk"/>

    <target name="-init">
        <mkdir dir="${jfx.deployed.dir}"/>
        <property name="fx.dt.dir" location="${jfx.deployed.dir}/public-dt-files"/>
    </target>

    <!-- Prepare a set of files to be embedded into the ant task.
         We expect them to be shipped with every sample in the "web-files" subdir -->
    <target name="deployfx-resources" depends="launcher">
        <property name="build.anttask.web.dir" value="build/deployfx/resources/web-files"/>
        <mkdir dir="${build.anttask.web.dir}"/>
        <ant target="js" inheritAll="false">
           <property name="fx.dt.dir" value="${build.anttask.web.dir}"/>
        </ant>
        <!-- Launcher classes -->
        <property name="build.anttask.class.dir"
                  value="build/deployfx/resources/classes"/>
        <mkdir dir="${build.anttask.class.dir}"/>
        <copy todir="${build.anttask.class.dir}">
           <fileset dir="javafx-launcher/build/classes">
              <include name="**/*.class"/>
           </fileset>
        </copy>
    </target>

    <!-- This step creates a local copy of DeployToolkit so you can test and try out your -->
    <!-- deployment locally. For production use, use the public DeployToolkit support. -->
    <target name="js" depends="-init"
           description="Copy deploy toolkit to output">
       <mkdir dir="${fx.dt.dir}"/>
       <copy file="javafx-deploy/src/js/dtjava.js" todir="${fx.dt.dir}"/>
       <copy file="lib/javafx-loading-100x100.gif" todir="${fx.dt.dir}" overwrite="true"/>
       <copy file="lib/javafx-loading-25x25.gif" todir="${fx.dt.dir}" overwrite="true"/>
       <copy file="lib/get_javafx.png" todir="${fx.dt.dir}" overwrite="true"/>
       <copy file="lib/javafx-chrome.png" todir="${fx.dt.dir}" overwrite="true"/>
       <copy file="lib/upgrade_javafx.png" todir="${fx.dt.dir}" overwrite="true"/>
       <copy file="lib/get_java.png" todir="${fx.dt.dir}" overwrite="true"/>
       <copy file="lib/upgrade_java.png" todir="${fx.dt.dir}" overwrite="true"/>
       <copy file="lib/error.png" todir="${fx.dt.dir}" overwrite="true"/>
    </target>

    <target name="launcher">
        <ant dir="javafx-launcher" target="jar"/>
    </target>

    <target name="anttasks" depends="packager"
            description="Prepare ant tasks used to deploy FX apps" />

    <target name="packager" depends="deployfx-resources">
        <ant dir="packager" antfile="build.xml"/>
    </target>

    <target name="man">
        <ant dir="man" antfile="build.xml"/>
    </target>

    <target name="clean">
        <ant dir="javafx-launcher" target="clean"/>
        <ant dir="packager" antfile="build.xml" target="clean"/>
        <ant dir="man" antfile="build.xml" target="clean"/>
        <delete dir="build" />
    </target>

    <!-- Targets required by and used by the top repository build. -->
    <target name="jfx-clean" depends="clean" />

    <target name="jfx-sdk"
            depends="launcher,js,anttasks,packager,man"/>

    <target name="jfx-deploy"/>
    <target name="jfx-clean-deploy" depends="clean"/>
    <target name="jfx-clean-sdk" />
    <target name="jfx-test"/>
    <target name="jfx-full-test"/>
    <target name="jfx-perf"/>
    <target name="jfx-sdk-docs"/>

</project>
