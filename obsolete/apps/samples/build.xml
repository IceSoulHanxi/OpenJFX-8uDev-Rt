<?xml version="1.0" encoding="UTF-8"?>
<project name="JavaFX apps - samples" default="default" basedir=".">

    <import file="../build-defs.xml"/>

    <target name="init">
        <echo message="Building samples"/>
    </target>

    <target name="jar-apps" depends="init">
        <!-- Build applications -->
        <ant dir="Ensemble8" target="jar" inheritAll="false"/>
    </target>

    <target name="dist-apps" depends="init,jar-apps">
        <mkdir dir="${jfx.apps.ga-samples.dir}"/>
        <mkdir dir="${jfx.apps.ga-samples.dist}"/>

        <!-- Build these apps into artifacts/apps/ga-samples -->
        <!-- Copy Ensemble8 jar -->
        <copy todir="${jfx.apps.ga-samples.dir}">
            <fileset dir="${basedir}/Ensemble8/dist">
                <include name="*.jar"/> <!-- should be good to copy -->
            </fileset>
        </copy>
       <!-- Copy src files -->
        <mkdir dir="${jfx.apps.ga-samples.dir}"/>
        <mkdir dir="${jfx.apps.ga-samples.dist}"/>
       <!-- Ensemble8 -->
        <mkdir dir="${jfx.apps.ga-samples.dist}/Ensemble8"/>
        <copy todir="${jfx.apps.ga-samples.dist}/Ensemble8">
            <fileset dir="${basedir}/Ensemble8">
                <exclude name="**/build/**"/>
                <exclude name="**/dist/**"/>
                <exclude name="**/nbproject/private/**"/>
                <exclude name="**/*.iml"/>
            </fileset>
        </copy>
        <!-- Remove build-tasks import from netbeans projects -->
        <replace dir="${jfx.apps.ga-samples.dist}/Ensemble8">
            <include name="build.xml"/>
            <replacetoken><![CDATA[<import file="../../build-tasks.xml"/>]]></replacetoken>
        </replace>
        <replace dir="${jfx.apps.ga-samples.dist}/Ensemble8">
            <include name="build.xml"/>
            <replacetoken><![CDATA[<target name="jfx-deployment">]]></replacetoken>
            <replacevalue><![CDATA[<target name="jfx-deployment">
        <taskdef resource="com/sun/javafx/tools/ant/antlib.xml"
            uri="javafx:com.sun.javafx.tools.ant"
            classpath="${java.home}/../lib/ant-javafx.jar"/>]]></replacevalue>
        </replace>
    </target>

    <target name="default" depends="dist-apps"/>

    <target name="clean" depends="init">
        <!-- Clean applications -->
        <ant dir="Ensemble8" target="clean" inheritAll="false"/>
    </target>

</project>
