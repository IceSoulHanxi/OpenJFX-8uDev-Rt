<?xml version="1.0" encoding="UTF-8"?>
<project name="prism-es2" default="all" basedir=".">

  <property name="javah.classpath" value="${prism-es2.classes.dir}:${prism-common.classes.dir}:${javac.classpath}"/>

  <!-- jni headers -->
  <target name="jheaders">
        <echo>Generate jheaders for prism-es2</echo>
        <mkdir dir="${native.build.dir}"/>
       <javah destdir="${native.build.dir}"
          classpath="${javah.classpath}"
               force="yes">
     <class name="com.sun.prism.es2.BufferFactory"/>
          <class name="com.sun.prism.es2.GLContext"/>
          <class name="com.sun.prism.es2.GLDrawable"/>
          <class name="com.sun.prism.es2.GLFactory"/>
          <class name="com.sun.prism.es2.GLGPUInfo"/>
          <class name="com.sun.prism.es2.GLPixelFormat"/>
        </javah>

       <javah destdir="${native.build.dir}"
          classpath="${javah.classpath}:../prism-es2-eglfb/build/classes"
               force="yes">
          <class name="com.sun.prism.es2.EGLFBGLContext"/>
          <class name="com.sun.prism.es2.EGLFBGLDrawable"/>
          <class name="com.sun.prism.es2.EGLFBGLFactory"/>
          <class name="com.sun.prism.es2.EGLFBGLPixelFormat"/>
        </javah>
  </target>

  <target name="compile-native">
   <antcall target="jheaders"/>
        <exec executable="${ndk.build.cmd}" dir="${cpp.dir}" failonerror="true">
     <arg line="APP_BUILD_SCRIPT=Android.mk NDK_PROJECT_PATH=. TARGET_PLATFORM=${android.ndk.target}"/>
        </exec>
        <copy todir="${native.dist.dir}" flatten="true">
       <fileset dir="../prism-es2-native/libs" includes="**/*.so"/>
       </copy>
  </target>

  <target name="clean-native">
      <delete dir="${cpp.dir}/libs"/>
      <delete dir="${cpp.dir}/obj"/>
      <delete dir="${cpp.dir}/dist"/>
      <delete dir="${cpp.dir}/build"/>
  </target>

</project>
