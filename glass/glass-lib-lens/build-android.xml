<?xml version="1.0" encoding="UTF-8"?>

<project name="glass-lib-lens-android" default="jar" basedir=".">
  <description>Builds, tests, and runs the project glass.</description>

  <import file="../../../build-defs.xml"/>

  <property name="build.dir" value="./build${cross.name.suffix}"/>
  <property name="jheaders.dir" value="${build.dir}/include"/>
  <property name="dist.dir" value="./dist${cross.name.suffix}"/>
  <property name="native.lib.file" value="libglass-lens-eglfb.so"/>
  <property name="glass.classpath" value="../glass/build/classes"/>

  <target name="jheaders" unless="uptodate">
   <mkdir dir="${jheaders.dir}" />
        <javah destdir="${jheaders.dir}" classpath="${glass.classpath}" force="yes">
            <class name="com.sun.glass.ui.android.SoftwareKeyboard"/>
            <class name="com.sun.glass.events.DndEvent"/>
            <class name="com.sun.glass.events.KeyEvent"/>
            <class name="com.sun.glass.events.MouseEvent"/>
            <class name="com.sun.glass.events.TouchEvent"/>
            <class name="com.sun.glass.events.ViewEvent"/>
            <class name="com.sun.glass.events.WindowEvent"/>
            <class name="com.sun.glass.ui.Application"/>
            <class name="com.sun.glass.ui.Cursor"/>
            <class name="com.sun.glass.ui.Menu"/>
            <class name="com.sun.glass.ui.MenuBar"/>
            <class name="com.sun.glass.ui.MenuItem"/>
            <class name="com.sun.glass.ui.Pixels"/>
            <class name="com.sun.glass.ui.Robot"/>
            <class name="com.sun.glass.ui.Screen"/>
            <class name="com.sun.glass.ui.Size"/>
            <class name="com.sun.glass.ui.Timer"/>
            <class name="com.sun.glass.ui.View"/>
            <class name="com.sun.glass.ui.View$Capability"/>
            <class name="com.sun.glass.ui.Window"/>
            <class name="com.sun.glass.ui.Window$Level"/>
            <class name="com.sun.glass.ui.lens.LensApplication"/>
            <class name="com.sun.glass.ui.lens.LensCursor"/>
            <class name="com.sun.glass.ui.lens.LensPixels"/>
            <class name="com.sun.glass.ui.lens.LensView"/>
            <class name="com.sun.glass.ui.lens.LensWindow"/>
            <class name="com.sun.glass.ui.lens.LensRobot"/>
            <class name="com.sun.glass.ui.lens.LensClipboardDelegate"/>
        </javah>
    </target>

    <target name="check-native">
     <uptodate property="uptodate" targetfile="libs/armeabi/${native.lib.file}" >
      <srcfiles dir="src" includes="**/*.c"/>
      <srcfiles dir="src" includes="**/*.h"/>
      <srcfiles dir="${glass.classpath}" includes="**/*.class"/>
     </uptodate>
  </target>

    <target name="compile-native-eglfb" unless="uptodate">
        <echo>Compile native-eglfb with command: ${android.ndk}/${ndk.build.cmd}</echo>
        <exec executable="${android.ndk}/${ndk.build.cmd}" dir="${basedir}" failonerror="true">
          <arg line="APP_BUILD_SCRIPT=Android.mk NDK_PROJECT_PATH=. TARGET_PLATFORM=${android.ndk.target}"/>
        </exec>
    </target>

    <target name="jar" depends="check-native, jheaders, compile-native-eglfb"/>

    <target name="clean">
       <delete dir="libs"/>
       <delete dir="obj"/>
       <delete dir="build"/>
       <delete dir="dist"/>
       <delete dir="bin"/>
    </target>

</project>
